# CNI实现方式

**一开始不确定flannel能否使用时，查找的资料**
SDN 网络；走主机的静态路由；overlay 网络，也叫隧道网络，我们使用这种方式；动态路由网络

---

### **1. SDN 网络（软件定义网络）**
SDN 是一种通过软件集中控制和管理网络架构的技术。它通过分离控制平面和数据平面，实现网络的灵活配置和动态调整。

#### **特点**：
- **集中控制**：通过控制器统一管理网络设备。
- **灵活配置**：可以根据需求动态调整网络策略。
- **复杂部署**：需要专门的 SDN 控制器和兼容的硬件设备。

---

### **2. 走主机的静态路由**
静态路由是一种手动配置路由表的方式，适用于网络结构简单、拓扑稳定的环境。

#### **特点**：
- **简单易用**：手动配置路由表，无需复杂协议。
- **稳定性高**：适合小型网络或固定拓扑。
- **维护成本低**：不需要动态路由协议的支持。

#### **实现步骤**：
1. **配置静态路由**：
   - 在主机上添加静态路由条目，指定目标网络和下一跳地址。
   - 例如，在 Linux 系统中可以使用 `ip route` 命令：
     ```bash
     sudo ip route add <目标网络> via <下一跳地址>
     ```
2. **测试通信**：
   - 使用 `ping` 或 `traceroute` 测试目标网络是否可达。
3. **持久化配置**：
   - 将静态路由配置写入网络配置文件（如 `/etc/network/interfaces`），确保重启后生效。

#### **适用场景**：
- 小型网络、固定拓扑环境或需要简单路由配置的场景。

---

### **3. Overlay 网络（隧道网络）**
Overlay 网络是一种在现有网络之上构建的虚拟网络，通过封装技术（如 VXLAN、GRE）实现跨物理网络的通信。

#### **特点**：
- **跨网络通信**：可以在不同物理网络之间建立虚拟连接。
- **灵活性高**：支持动态扩展和迁移。
- **性能开销**：由于封装和解封装，可能会引入额外的性能开销。

#### **实现技术**：
- **VXLAN**：虚拟扩展局域网，适用于大规模虚拟化环境。
- **GRE**：通用路由封装，适用于点对点隧道。
- **IPSec**：提供加密和认证功能，适用于安全通信。

---

### **4. 动态路由网络**
动态路由通过路由协议（如 OSPF、BGP）自动学习和更新路由表，适用于复杂网络环境。

#### **特点**：
- **自动学习**：根据网络拓扑动态更新路由表。
- **适应性强**：能够快速响应网络变化。
- **配置复杂**：需要配置和维护路由协议。

#### **常见协议**：
- **OSPF**：开放最短路径优先，适用于内部网络。
- **BGP**：边界网关协议，适用于互联网或大型网络。

---

### **静态路由的具体实现示例**
以下是一个基于 **走主机的静态路由** 的具体实现示例，假设有两个主机需要通信：

#### **场景**：
- 主机 A：IP 地址为 `192.168.1.10`，网关为 `192.168.1.1`。
- 主机 B：IP 地址为 `192.168.2.10`，网关为 `192.168.2.1`。
- 主机 A 和主机 B 之间需要通过静态路由通信。

#### **步骤**：
1. **在主机 A 上配置静态路由**：
   ```bash
   sudo ip route add 192.168.2.0/24 via 192.168.1.1
   ```
2. **在主机 B 上配置静态路由**：
   ```bash
   sudo ip route add 192.168.1.0/24 via 192.168.2.1
   ```
3. **测试通信**：
   - 在主机 A 上执行：
     ```bash
     ping 192.168.2.10
     ```
   - 在主机 B 上执行：
     ```bash
     ping 192.168.1.10
     ```
4. **持久化配置**：
   - 在 `/etc/network/interfaces` 中添加静态路由配置：
     ```bash
     up ip route add 192.168.2.0/24 via 192.168.1.1
     ```

---
